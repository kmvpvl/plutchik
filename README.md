# `!DRAFT!` Plutchik API
API for dating sevices based on studies of Robert Plutchik. 
[See Wikipedia about R.Plutchik studies](#https://en.wikipedia.org/wiki/Robert_Plutchik)

---
## Content

[Introduction](#introduction)

[How to contrubute](#how-to-contrubute)

[How to get started](#how-to-get-started)

[How to add content](#how-to-add-content)

[How to add users](#how-to-add-users)

[Why it's free for dating services](#why-its-free-for-dating-services)

[References](#references)

---
## Introduction

![<img width="10px"/>](https://upload.wikimedia.org/wikipedia/commons/thumb/c/ce/Plutchik-wheel.svg/300px-Plutchik-wheel.svg.png)

API helps feeding users with content to be assessed. API matchs users according with their evaluations. API can recommend content to increase precsion of matching.

Collecting of assessments is anonymous fully. Plutchik API don't collect names or other information about users' identification in dating service. Every user gets new uniq id generated by Plutchik API. This uniq id is known to dating service only. We consider to publish code for your and users assurance. Our authrization model is safe for users and anonymous fully.

---
## How to contrubute

---
## How to get started

You need register organization and get `organizationid` and `organizationkey` with supervisor role.
Further you will be able to create new organization keys with exact [roles](#roles): create_user, create_content etc.  

---
## How to add users
Method [adduser](#adduser-method) creates new user who can request new content items and assess them. Methods [blockuser](#blockuser-method) and [unblockuser](#unblockuser-method) manage users' state of visibility and ability of getting new content to assessment

---
## How to add content

Use methods [addcontent](#addcontent-method) to add new items and change existing items in collection. Methods [blockcontent](#blockcontent-method) and [unblockcontent](#unblockcontent-method) make items visible or hiding from users.

For editing content item structure use [Content](#content-object) object.

For editing content items you must have organizationkey with create_content role. Users can't create or edit content items. They can assess them only. Organizations can create and edit content. 


## How to add assesment by uses

## How to get matches

## How to discover new users from other dating services or psycology teams

## Why it's free for dating services

## Authorization schemas

## Roles

## API
|object|Description|
|---|---|
|[User](#user-object)| User who can evaluate content and get matched with other users|
|[Content](#content-object)| Item (unit) for evaluation by user in Plutchik's wheel|


|method|Description|
|---|-|
|[version](#version)| Gets version Plutchik API|
|üìÅ **USER management**|
|[adduser](#adduser-method)| Adds new user|
|[getsessiontoken](#getsessiontoken-method)| Gets session token for user|
|[blockuser](#blockuser-method)| Block user|
|[unblockuser](#unblockuser-method)| Unblock user|
|üìÅ **CONTENT management**|
|[addcontent](#addcontent-method)| Adds new content item|
|[blockcontent](#blockcontent-method)| Block content item|
|[unblockcontent](#unblockcontent-method)| Unblock content item|


---
* ### **`User` object**
```
interface IUser {
    _id: Types.ObjectId;
    organizationid: Types.ObjectId;
    birthdate: Date;
    nativelanguage: string;
    secondlanguages: Array<string>,
    location: string;
    gender: string;
    maritalstatus: string;
    features: string;
    blocked: boolean;
    created: Date;
    changed: Date;
}    
```
---
* ### **`Content` object**
```
export interface IContent {
    _uid: Types.ObjectId;
    type: ContentTypes;
    url: string;
    name: string;
    description: string;
    language: string;
    restrictions: Array<string>;
    organizationidref?: Types.ObjectId;
    foruseronlyidref?: Types.ObjectId;
    blocked: boolean;
    created: Date;
    changed: Date;
}
```
---
* ### **`version`** method
    Description: returns object with values of versions: api, data, ai
    
    Method: `GET`

    Parameters: `NONE`

    Security schema: `NONE`

    Returns: 
    
    * object version {api: x.x.x, data: x.x.x, ai: x.x.x}
    * format application/json


    [Back to API üëÜ](#api)
---
* ### **`adduser`** method
    Description: creates user or updates existing user. Returns actual user information 
    
    Method: `POST`

    Parameters: 
        
    | Parameter | description | Format | Where |Mandatory|
    | --- | --- | --- | --- | --- |
    | `organizationid` | Uniq id of organization | MongoDB uuid | header |‚úÖ
    | `organizationkey`| Key recieved from Plutchik API with exact roles| MongoDB uuid | header | ‚úÖ
    |`userinfo`||||‚úÖ|
    |`userinfo.userid` | Uniq user id of user which info changed. Can be empty or absent, then new user will be created | MongoDB uuid | query|
    |`userinfo.birthdate`|User's birthdate|YYYY-mm-dd|query|
    |`userinfo.nativelanguage`|User's native language|string|query|
    |`userinfo.secondlanguages`|Other user's languages that can be used|Array of string|query|
    |`userinfo.location`|String as 'lat: xx.xxxxx, lng: yy.yyyyy' or 'Prague, Czech' etc. which describes user's location|string|query|
    |`userinfo.gender`|User's gender in his(her,...) opinion|string|query|
    |`userinfo.maritalstatus`| User's marital status in one's opinion| string|query|
    |`userinfo.features`|Any information about user|string|query|



    Security schemas: 
    ` PlutchikAuthOrganizationId & PlutchikAuthOrganizationKey`

    Returns: 
    * format: `application/json`
    * data: [User](#user) object

    Request example:
    ```
    POST http://localhost:8000/adduser
    Content-Type: application/json
    organizationid: 63c0e7dad80176886c22129d
    organizationkey: 63c2875ecb60f72dc1eb6bbb
    userid: 63c28926cb60f72dc1eb6bbf

    {
        "userinfo": {
            "birthdate": "1972-07-23",
            "nativelanguage": "English",
            "secondlanguages": ["French", "Ukrain"],
            "location": "Prague",
            "gender": "male",
            "maritalstatus": "single",
            "features": "extra",
            "blocked": "false"
        }
    }
    ```

    [Back to API üëÜ](#api)
---
* ### **`getsessiontoken`** method
    Description: returns session token for user 
    
    Method: `GET`

    Parameters: 
        
    | Parameter | description | Format | Where |Mandatory|
    | --- | --- | --- | --- |---|
    | `organizationid` | Uniq id of organization | MongoDB uuid | header |‚úÖ
    | `organizationkey`| Key recieved from Plutchik API with exact roles| MongoDB uuid | header | ‚úÖ
    | `userid` | User which session token requsted for | MongoDB uuid | header|‚úÖ


    Security schemas: 
    ` PlutchikAuthOrganizationId & PlutchikAuthOrganizationKey & PlutchikAuthUserId`

    Returns: 
    
    * text string MongoDB uuid 
    * format application/json

    [Back to API üëÜ](#api)
---
* ### **`blockuser`** method
    Description: Blocks user. After that user can't assess content and can't get matched
    
    Method: `GET`

    Parameters: 
        
    | Parameter | description | Format | Where |Mandatory|
    | --- | --- | --- | --- |---|
    | `organizationid` | Uniq id of organization | MongoDB uuid | header |‚úÖ
    | `organizationkey`| Key recieved from Plutchik API with exact roles| MongoDB uuid | header | ‚úÖ
    | `userid` | User which session token requsted for | MongoDB uuid | header|‚úÖ


    Security schemas: 
    ` PlutchikAuthOrganizationId & PlutchikAuthOrganizationKey & PlutchikAuthUserId`

    Returns: NONE

    [Back to API üëÜ](#api)
---
* ### **`unblockuser`** method
    Description: Unblocks user. After that user can assess content and can get matched
    
    Method: `GET`

    Parameters: 
        
    | Parameter | description | Format | Where |Mandatory|
    | --- | --- | --- | --- |---|
    | `organizationid` | Uniq id of organization | MongoDB uuid | header |‚úÖ
    | `organizationkey`| Key recieved from Plutchik API with exact roles| MongoDB uuid | header | ‚úÖ
    | `userid` | User which session token requsted for | MongoDB uuid | header|‚úÖ


    Security schemas: 
    ` PlutchikAuthOrganizationId & PlutchikAuthOrganizationKey & PlutchikAuthUserId`

    Returns: `NONE`

    [Back to API üëÜ](#api)
---
* ### **`addcontent`** method
    Description: creates content or updates existing content item. Returns actual content item 
    
    Method: `POST`

    Parameters: 
        
    | Parameter | description | Format | Where |Mandatory|
    | --- | --- | --- | --- | --- |
    | `organizationid` | Uniq id of organization | MongoDB uuid | header |‚úÖ
    | `organizationkey`| Key recieved from Plutchik API with exact roles| MongoDB uuid | header | ‚úÖ
    |`contentinfo`|||query|‚úÖ|
    |`contentinfo._id` | Uniq content item's id. It can be empty or absent, then new content item will be created | MongoDB uuid | query|
    |`contentinfo.type`|String one of values: text, audio, video, image, memes|string|query|‚úÖ|
    |`contentinfo.url`|URL located the content item|string|query|‚úÖ|
    |`contentinfo.name`|Name of content item|string|query|‚úÖ|
    |`contentinfo.tags`|User's native language|string|query|‚úÖ|
    |`contentinfo.description`|Description of content item|Array of string|query|‚úÖ|
    |`contentinfo.language`|language of content item|string|query|‚úÖ|
    |`contentinfo.restrictions`|Array of restrictions|Array of strings|query|
    |`contentinfo.blocked`| Blocked or unblocked content item| string: "true" or "false"|query|
    |`contentinfo.expired`|Date time after that content item will be hide from users|string RFC3339|query|
    |`contentinfo.validfrom`|Date time before that content item is hide from users|string RFC3339|query|



    Security schemas: 
    ` PlutchikAuthOrganizationId & PlutchikAuthOrganizationKey`

    Returns: 
    * format: `application/json`
    * data: [User](#user) object

    Request example:
    ```
    POST http://localhost:8000/adduser
    Content-Type: application/json
    organizationid: 63c0e7dad80176886c22129d
    organizationkey: 63c2875ecb60f72dc1eb6bbb
    userid: 63c28926cb60f72dc1eb6bbf

    {
        "userinfo": {
            "birthdate": "1972-07-23",
            "nativelanguage": "English",
            "secondlanguages": ["French", "Ukrain"],
            "location": "Prague",
            "gender": "male",
            "maritalstatus": "single",
            "features": "extra",
            "blocked": "false"
        }
    }
    ```

    [Back to API üëÜ](#api)
---
* ### **`blockcontent`** method
    Description: Blocks content item. After that users can't find and assess this content
    
    Method: `GET`

    Parameters: 
        
    | Parameter | description | Format | Where |Mandatory|
    | --- | --- | --- | --- |---|
    | `organizationid` | Uniq id of organization | MongoDB uuid | header |‚úÖ
    | `organizationkey`| Key recieved from Plutchik API with exact roles| MongoDB uuid | header | ‚úÖ
    | `cid` | Content item's uniq id | MongoDB uuid | path|‚úÖ


    Security schemas: 
    ` PlutchikAuthOrganizationId & PlutchikAuthOrganizationKey`

    Returns: NONE

    [Back to API üëÜ](#api)
---
* ### **`unblockcontent`** method
    Description: Unblocks content item. After that user can find and assess this content item
    
    Method: `GET`

    Parameters: 
        
    | Parameter | description | Format | Where |Mandatory|
    | --- | --- | --- | --- |---|
    | `organizationid` | Uniq id of organization | MongoDB uuid | header |‚úÖ
    | `organizationkey`| Key recieved from Plutchik API with exact roles| MongoDB uuid | header | ‚úÖ
    | `cid` | Content item's uniq id | MongoDB uuid | path|‚úÖ


    Security schemas: 
    ` PlutchikAuthOrganizationId & PlutchikAuthOrganizationKey`

    Returns: `NONE`

    [Back to API üëÜ](#api)
---

## References
1. [Wikipedia](#https://en.wikipedia.org/wiki/Robert_Plutchik) about R.Plutchik studies